<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>Redirecting...</title>
  <script>
    const id = window.location.hash.replace("#", "") || "0";
    const deepLink = `myapp://user/${id}`;

    const isAndroid = /android/i.test(navigator.userAgent);
    const isIOS = /iPhone|iPad|iPod/i.test(navigator.userAgent);

    // Use different fallbacks
    const androidFallback = "https://play.google.com/store/apps/details?id=com.whatsapp";
    const iosFallback = "https://apps.apple.com/app/id310633997"; // WhatsApp iOS App Store
    const fallback = isAndroid ? androidFallback : iosFallback;

    let fallbackTimeout;

    document.addEventListener('visibilitychange', () => {
      if (document.visibilityState === 'hidden') {
        clearTimeout(fallbackTimeout);
      }
    });

    window.location.replace(deepLink);

    fallbackTimeout = setTimeout(() => {
      window.location.href = fallback;
    }, 1500);
  </script>
</head>
<body>
  <p>Opening your appâ€¦</p>
</body>
</html>
